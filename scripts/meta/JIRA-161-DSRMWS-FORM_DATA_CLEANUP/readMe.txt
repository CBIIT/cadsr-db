The script FORMS_CLEANUP_VW_SCR.sql created to allocate and delete all invalid records from tables populated by FB or FL.
1. For the script result accuracy, simplicity and readability the view SBREXT.MDSR_VALID_FORM_ELEMETS_VIEW was created.
  The view contains only Valid Form Elements.

2.The only records of QUEST_CONTENTS_EXT table with QTL_NAME in ('CRF','TEMPLATE') have no parent records. 
 All other records must be associated with existing parent records QUEST_CONTENTS_EXT.
After allocating invalid records in QUEST_CONTENTS_EXT, all associated records have to be removed from following tables before deleting from QUEST_CONTENTS_EXT .

1. VALID_VALUES_ATT_EXT                          
2. QUEST_ATTRIBUTES_EXT             
3. TA_PROTO_CSI_EXT                   
4. PROTOCOL_QC_EXT                   
5. TRIGGERED_ACTIONS_EXT              
6. QUEST_VV_EXT                    
7. QC_RECS_EXT             

3.The attached script FORMS_PRE_CLEANUP_VW_SCR.sql will allocate and clean all invalid records from 8 tables.

TABLE_NAME	Records in caDSR	Records to be migrated	Records to be deleted
1. VALID_VALUES_ATT_EXT	2091526	2089305	2221
2. QUEST_ATTRIBUTES_EXT	330894	330418	476
3. TA_PROTO_CSI_EXT	24	24	0
4. PROTOCOL_QC_EXT	16811	16811	0
5. TRIGGERED_ACTIONS_EXT	328	328	0
6. QUEST_VV_EXT	218296	218296	0
7. QC_RECS_EXT	2662969	2659587	3382

QUEST_CONTENTS_EXT	FORMS	MODULES	QUESTIONS	VALID VALUES	FORM_INSTR	INSTRUCTIONS	FOOTER	MODULE_INSTR	QUESTION_INSTR	VALUE_INSTR
Records before cleanup	18892	62691	330925	2095290	7142	186	1430	20508	102249	47204
Records to be migrated	18892	62673	330448	2089798	7140	186	1430	20278	100914	46721
Records to cleanup	0	18	477	5492	2	0	0	230	1335	483


4. In addition,  the script generates the output file DSRMWS-161VW.log. 
https://github.com/CBIIT/cadsr-db/blob/master/scripts/meta/JIRA-161-DSRMWS-FORM_DATA_CLEANUP/DSRMWS-161DEV.log
The file DSRMWS-161VW.log can be used to review and test the cleaning process result.
The file presents: 
1.	Summary of tables with records  which have to be deleted and migrated before cleaning process.
          2.   DB massages generated by cleaning process.
          3.   Summary of tables with records  which have to be deleted and migrated after cleaning process.

5. As we discussed prior, the DB script does not allocate or delete invalid records in the following tables:
     SBR. ADMINISTERED_COMPONENTS
     SBR.AS_CSI, SBR.DEFINITIONS,    
     SBR.DESIGNATIONS, 
     SBR.REFERENCE_DOCUMENTS, 
     SBR.REFERENCE_BLOBS
Please review the attached files.
